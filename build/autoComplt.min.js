var autoComplt=function(){var t=0,e={autoCompltListClass:"autoComplt-list",autoCompltHintClass:"autoComplt-hint",autoCompltHintSelectedClass:"autoComplt-hint-selected",maxHintNum:10,autoCompltDelay:100,listStatus:{attr:"data-listStatus",open:"open"},keyCode:{up:38,down:40,esc:27,enter:13},defaultStyles:{autoCompltList:{maxHeight:"none",border:"1px solid #aaa",padding:"0",margin:"0",zIndex:99,overflowX:"hidden",overflowY:"auto",display:"none",position:"absolute",backgroundColor:"#fff"},autoCompltHint:{height:"1.5em",padding:"2px 6px 2px 10px",margin:"6px 0",overflow:"hidden",listStyleType:"none",color:"#000",backgroundColor:"#fff",cursor:"default",fontSize:"1em"},autoCompltHintSelected:{color:"#fff",backgroundColor:"#3399ff"}},adjStyleAttrs:{autoCompltList:["border","maxHeight","backgroundColor"],autoCompltHint:["height","padding","margin","color","backgroundColor","fontSize"],autoCompltHintSelected:["color","backgroundColor"]}},o=function(t){return t=t||window.event,t.target=t.target||t.srcElement,t.stopBubble=function(){this.cancelBubble=!0,this.stopPropoagation&&this.stopPropoagation()},t.stopDefault=function(){return this.preventDefault&&this.preventDefault(),this.returnValue=!1,!1},t},l=function(t,e,o){t.addEventListener?t.addEventListener(e,o):t.attachEvent&&t.attachEvent("on"+e,o)},i=function(t,e,o){t.removeEventListener?t.removeEventListener(e,o):t.detachEvent&&t.detachEvent("on"+e,o)},n=function(t,e){var o=null;if(window.getComputedStyle)o=window.getComputedStyle(t)[e]||null;else if(t.currentStyle){o=t.currentStyle&&t.currentStyle[e];var l,i,n=t.style;null==o&&n&&n[e]&&(o=n[e]),l=n.left,i=t.runtimeStyle&&t.runtimeStyle.left,i&&(t.runtimeStyle.left=t.currentStyle.left),n.left="fontSize"===e?"1em":o,o=n.pixelLeft+"px",n.left=l,i&&(t.runtimeStyle.left=i)}return o},s={buildElem:function(t){var e=document.createElement("DIV");return e.innerHTML=t,e.firstChild.cloneNode(!0)},buildHint:function(t,o){if("string"==typeof t&&t){var t=this.buildElem('<li class="'+e.autoCompltHintClass+'">'+t+"</li>");return t.style.height=t.style.lineHeight=o.autoCompltHint.height,t.style.padding=o.autoCompltHint.padding,t.style.margin=o.autoCompltHint.margin,t.style.overflow=o.autoCompltHint.overflow,t.style.listStyleType=o.autoCompltHint.listStyleType,t.style.color=o.autoCompltHint.color,t.style.backgroundColor=o.autoCompltHint.backgroundColor,t.style.cursor=o.autoCompltHint.cursor,t.style.fontSize=o.autoCompltHint.fontSize,t}return null},buildList:function(t){var o=this.buildElem('<ul class="'+e.autoCompltListClass+'"></ul>');return o.style.maxHeight=t.autoCompltList.maxHeight,o.style.border=t.autoCompltList.border,o.style.padding=t.autoCompltList.padding,o.style.margin=t.autoCompltList.margin,o.style.zIndex=t.autoCompltList.zIndex,o.style.overflowX=t.autoCompltList.overflowX,o.style.overflowY=t.autoCompltList.overflowY,o.style.display=t.autoCompltList.display,o.style.position=t.autoCompltList.position,o.style.backgroundColor=t.autoCompltList.backgroundColor,o}},a=function(t){this.uiElem=null,this.assocInput=t,this.mouseOnList=!1,this.pauseMouseoverSelection=!1,this.pauseMouseoutDeselection=!1,this.maxHintNum=e.maxHintNum,this.styles=JSON.parse(JSON.stringify(e.defaultStyles))};a.prototype.genList=function(){if(!this.uiElem){var t=this;this.uiElem=s.buildList(this.styles),l(this.uiElem,"mouseover",function(e){e=o(e),t.isHint(e.target)&&(t.select(e.target),t.autoScroll())}),l(this.uiElem,"mouseout",function(e){e=o(e),t.deselect()}),l(this.uiElem,"mousedown",function(e){e=o(e),t.mouseOnList=!0,setTimeout(function(){t.assocInput.focus()},50)}),l(this.uiElem,"mouseup",function(e){e=o(e),t.isHint(e.target)&&(t.select(e.target),t.assocInput.value=t.getSelected().innerHTML,t.assocInput.autoComplt.close())}),document.body.appendChild(this.uiElem)}},a.prototype.isHint=function(t){if(t&&"object"==typeof t&&1===t.nodeType){var o=" "+t.className+" ";return o.indexOf(" "+e.autoCompltHintClass+" ")>=0}return!1},a.prototype.putHints=function(t){var e=0;if(t instanceof Array){var o,l,i=[];for(l=Math.min(t.length,this.maxHintNum),o=0;l>o;o++)i.push(s.buildHint(t[o],this.styles)),i[i.length-1]||i.pop();if(i.length>0){var n=document.createDocumentFragment();for(o=0,e=i.length;e>o;o++)n.appendChild(i[o]);this.clearHints(),this.genList(),this.uiElem.appendChild(n)}}return e},a.prototype.clearHints=function(){this.uiElem&&(this.uiElem.innerHTML="")},a.prototype.isOpen=function(){return this.uiElem?this.uiElem.getAttribute(e.listStatus.attr)==e.listStatus.open:!1},a.prototype.open=function(){var t;if(this.uiElem&&(t=this.uiElem.querySelectorAll("."+e.autoCompltHintClass))&&t.length){var o,l;for(l=this.assocInput.getBoundingClientRect(),this.uiElem.style.top=(document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+l.bottom+"px",this.uiElem.style.left=l.left+"px",l=l.right-l.left-parseFloat(n(this.uiElem,"borderLeftWidth"))-parseFloat(n(this.uiElem,"borderRightWidth")),this.uiElem.style.width=l+"px",o=0,l=0;o<t.length;o++)l+=parseFloat(n(t[o],"height"))+parseFloat(n(t[o],"paddingTop"))+parseFloat(n(t[o],"paddingBottom")),t[o+1]&&(l+=Math.max(parseFloat(n(t[o],"marginBottom")),parseFloat(n(t[o+1],"marginTop"))));l+=parseFloat(n(t[0],"marginTop"))+parseFloat(n(t[t.length-1],"marginBottom")),this.uiElem.style.height=l+1+"px",this.uiElem.setAttribute(e.listStatus.attr,e.listStatus.open),this.uiElem.style.display="block"}},a.prototype.close=function(){this.uiElem&&!t&&(this.mouseOnList=!1,this.uiElem.parentNode.removeChild(this.uiElem),this.uiElem=null)},a.prototype.autoScroll=function(){var t=this.getSelected();if(t){var e,o=0,l=0,i=t.clientHeight,s=parseFloat(n(t,"marginTop")),a=parseFloat(n(t,"marginBottom"));for(e=t.previousSibling,l=i+(e?Math.max(s,a):s);e;)o+=i,e=e.previousSibling,o+=e?Math.max(s,a):s;(this.uiElem.clientHeight+this.uiElem.scrollTop-o<l||o-this.uiElem.scrollTop<l)&&(this.uiElem.scrollTop=o)}},a.prototype.select=function(t){if(this.uiElem){var o=null;if(this.isHint(t))o=t;else if("number"==typeof t&&(t>=0||-1===t)){var l=this.uiElem.querySelectorAll("."+e.autoCompltHintClass);l.length>0&&(o=+t,o=-1===o||o>l.length-1?l.length-1:o,o=l[o])}null!==o&&(this.deselect(),o.className+=" "+e.autoCompltHintSelectedClass,o.style.color=this.styles.autoCompltHintSelected.color,o.style.backgroundColor=this.styles.autoCompltHintSelected.backgroundColor)}},a.prototype.deselect=function(){if(this.uiElem){var t=this.getSelected();t&&(t.className=e.autoCompltHintClass,t.style.color=this.styles.autoCompltHint.color,t.style.backgroundColor=this.styles.autoCompltHint.backgroundColor)}},a.prototype.getSelected=function(){return this.uiElem?this.uiElem.querySelector("."+e.autoCompltHintSelectedClass)||null:null};var u={enable:function(t,n){if(t&&"object"==typeof t&&"string"==typeof t.tagName&&"input"==t.tagName.toLowerCase()&&"text"==t.type&&1===t.nodeType&&!t.autoComplt){t.autoComplt={};var s=e.autoCompltDelay,u=!0,r="",p=null,m=new a(t),c=function(){if(this.value.length>0&&u&&"function"==typeof p&&r!==this.value){var e={};e.call=function(){p.call(e.that,e.compltTarget,e.openHint)},e.that=t,e.compltTarget=r=this.value,e.openHint=function(t){e.compltTarget===r&&(m.putHints(t)?m.open():e.that.autoComplt.close())},setTimeout(e.call,s)}},d=function(){if(u){var t=m.getSelected();this.value=t?t.innerHTML:r}},h=function(e){e=o(e),m.mouseOnList?(t.focus(),m.mouseOnList=!1):t.autoComplt.close()},f=function(l){if(l=o(l),u)if("keydown"!=l.type||!m.isOpen()||l.keyCode!==e.keyCode.up&&l.keyCode!==e.keyCode.down){if("keyup"==l.type){var i=!1;switch(l.keyCode){case e.keyCode.up:case e.keyCode.down:m.isOpen()||(i=!0);break;case e.keyCode.esc:m.isOpen()&&(t.value=r,t.autoComplt.close());break;case e.keyCode.enter:m.isOpen()&&(d.call(t),t.autoComplt.close());break;default:i=!0}i&&(t.value.length>0?c.call(t):t.autoComplt.close())}}else{var n=m.getSelected();l.keyCode===e.keyCode.up?n?n.previousSibling?m.select(n.previousSibling):m.deselect():m.select(-1):l.keyCode===e.keyCode.down&&(n?n.nextSibling?m.select(n.nextSibling):m.deselect():m.select(0)),m.autoScroll(),d.call(t)}};return t.autoComplt.setHintsFetcher=function(t){return"function"==typeof t?(p=t,!0):!1},t.autoComplt.config=function(t){if(t instanceof Object){var e,o={};return e=Math.floor(t.delay),e>0&&(s=o.delay=e),e=Math.floor(t.maxHintNum),e>0&&(m.maxHintNum=o.maxHintNum=e),o}return!1},t.autoComplt.setStyles=function(t,o){var l,i,n=!1;switch(t){case e.autoCompltListClass:l=m.styles.autoCompltList,i=e.adjStyleAttrs.autoCompltList;break;case e.autoCompltHintClass:l=m.styles.autoCompltHint,i=e.adjStyleAttrs.autoCompltHint;break;case e.autoCompltHintSelectedClass:l=m.styles.autoCompltHintSelected,i=e.adjStyleAttrs.autoCompltHintSelected}if(o instanceof Object&&l&&i)for(var s=0;s<i.length;s++)("string"==typeof o[i[s]]||"number"==typeof o[i[s]])&&(n||(n={}),n[i[s]]=l[i[s]]=o[i[s]]);return n},t.autoComplt.close=function(){r="",m.close()},t.autoComplt.enable=function(){u=!0},t.autoComplt.disable=function(){this.close(),u=!1},t.autoComplt.destroy=function(){i(t,"blur",h),i(t,"keyup",f),i(t,"keydown",f),this.close(),delete t.autoComplt},l(t,"blur",h),l(t,"keyup",f),l(t,"keydown",f),n instanceof Object&&(t.autoComplt.config(n),t.autoComplt.setHintsFetcher(n.hintsFetcher)),t}return null}};return u}();